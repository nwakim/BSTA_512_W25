{
  "hash": "6a2e78295cb39c76f1fb17408ac5e61a",
  "result": {
    "markdown": "---\ntitle: \"BMI Variable Help\"\nsubtitle: \"BSTA 512/612\"\ndate-modified: \"today\"\ncategories: [\"\"]\nformat: \n  html:\n    link-external-newwindow: true\n    toc: true\n    toc-depth: 4\n  pdf: default \neditor_options: \n  chunk_output_type: console\n---\n\n\n\n[Link to github page for `qmd` file](https://github.com/nwakim/BSTA_512_W25/blob/main/labs/BMI_help.qmd)\n\n#### Loading the needed packages:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gtsummary)\nlibrary(here)\nif(!require(lubridate)) { install.packages(\"lubridate\"); library(lubridate) }\n```\n:::\n\n\n\n#### Loading my IAT dataset (as it's Rda file):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file = here(\"../TA_files/Project/data/IAT_data.rda\"))\n```\n:::\n\n\n\n#### Selecting the variables that I want to look at:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep = iat_2021_raw %>% \n  select(IAT_score = D_biep.Thin_Good_all, \n         att7, iam_001, identfat_001, \n         myweight_002, myheight_002,\n         identthin_001, controlother_001, \n         controlyou_001, mostpref_001,\n         important_001, \n         birthmonth, birthyear, month, year, \n         raceomb_002, raceombmulti, ethnicityomb, \n         edu, edu_14, \n         genderIdentity, \n         birthSex)\n```\n:::\n\n\n\n### Self-reported BMI\n\nI started investigating the BMI because I was curious how the paper [@elran-barak2018] used it and just wanted to check reproducibility. There are a few issues with the self-reported BMI that immediately stuck out:\n\n-   Components of BMI (weight and height) were self-reported\n\n    -   People told they are underweight often add pounds (REFERENCE)\n\n    -   People told they are overweight often subtract pounds (REFERENCE)\n\n-   Raw data from weight and height are categorical. This is according to the codebook associated with this dataset. Please find your codebook file named `Weight_IAT_public_2021_codebook.csv` . You can find the value names for `myweight_002` and `myheight_002`.\n\n    For example, in the weight variable,\n\n    -   most categories identify a lower limit to the weight in the group. One example group is weight is greater than or equal to 200 pounds and less than 205 pounds (labelled as \"200 lb :: 91 kg\").\n\n    -   the first category for weight is \"below 50lb:: 23kg\" with 258 observations\n\n    -   the last category for weight is \"above 440lb:: above 200kg\" with 295 observations\n\n        -   While the 5 groups of weight leading up the last category have 33, 28, 34, 20, and 89 observations, respectively.\n\n    -   My intention here is not the question anyone's weight, but keep in mind that surveys sometimes have people selecting the first or last option because they are not taking the survey seriously\n\n#### My exact steps\n\n1.  I wanted to get a table of the counts within each weight group. I used the `gt` package to make a table of what I thought was a categorical variable. It looks like R interprets the numbered categories as numbers.\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    iat_prep %>%\n      dplyr::select(myweight_002) %>%\n      tbl_summary()\n    ```\n    \n    ::: {.cell-output-display}\n    \\begin{table}\n    \\fontsize{12.0pt}{14.4pt}\\selectfont\n    \\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lc}\n    \\toprule\n    \\textbf{Characteristic} & \\textbf{N = 465,886}\\textsuperscript{\\textit{1}} \\\\ \n    \\midrule\\addlinespace[2.5pt]\n    myweight\\_002 & 23 (18, 29) \\\\ \n        Unknown & 141,326 \\\\ \n    \\bottomrule\n    \\end{tabular*}\n    \\begin{minipage}{\\linewidth}\n    \\textsuperscript{\\textit{1}}Median (Q1, Q3)\\\\\n    \\end{minipage}\n    \\end{table}\n    :::\n    :::\n\n\n\n2.  I will first check the class of the variable to make sure R is doing what I think it's doing.\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    class(iat_prep$myweight_002)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] \"integer\"\n    ```\n    :::\n    :::\n\n\n\n    So R is interpreting the values as integers. I will need to make them categories to view them through `gt` commands.\n\n3.  Let's make it a category:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    iat_prep2 = iat_prep %>% \n      mutate(myweight = as.factor(myweight_002))\n    ```\n    :::\n\n\n\n4.  Now we make the table:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    iat_prep2 %>%\n      dplyr::select(myweight) %>%\n      tbl_summary()\n    ```\n    \n    ::: {.cell-output-display}\n    \\begin{table}\n    \\fontsize{12.0pt}{14.4pt}\\selectfont\n    \\begin{tabular*}{\\linewidth}{@{\\extracolsep{\\fill}}lc}\n    \\toprule\n    \\textbf{Characteristic} & \\textbf{N = 465,886}\\textsuperscript{\\textit{1}} \\\\ \n    \\midrule\\addlinespace[2.5pt]\n    myweight &  \\\\ \n        1 & 258 (<0.1\\%) \\\\ \n        2 & 257 (<0.1\\%) \\\\ \n        3 & 329 (0.1\\%) \\\\ \n        4 & 363 (0.1\\%) \\\\ \n        5 & 379 (0.1\\%) \\\\ \n        6 & 329 (0.1\\%) \\\\ \n        7 & 327 (0.1\\%) \\\\ \n        8 & 360 (0.1\\%) \\\\ \n        9 & 589 (0.2\\%) \\\\ \n        10 & 1,002 (0.3\\%) \\\\ \n        11 & 2,180 (0.7\\%) \\\\ \n        12 & 3,766 (1.2\\%) \\\\ \n        13 & 6,175 (1.9\\%) \\\\ \n        14 & 9,038 (2.8\\%) \\\\ \n        15 & 12,068 (3.7\\%) \\\\ \n        16 & 15,598 (4.8\\%) \\\\ \n        17 & 16,007 (4.9\\%) \\\\ \n        18 & 17,518 (5.4\\%) \\\\ \n        19 & 19,093 (5.9\\%) \\\\ \n        20 & 17,794 (5.5\\%) \\\\ \n        21 & 15,599 (4.8\\%) \\\\ \n        22 & 16,636 (5.1\\%) \\\\ \n        23 & 14,854 (4.6\\%) \\\\ \n        24 & 14,643 (4.5\\%) \\\\ \n        25 & 13,510 (4.2\\%) \\\\ \n        26 & 12,778 (3.9\\%) \\\\ \n        27 & 12,243 (3.8\\%) \\\\ \n        28 & 11,498 (3.5\\%) \\\\ \n        29 & 9,414 (2.9\\%) \\\\ \n        30 & 9,099 (2.8\\%) \\\\ \n        31 & 7,274 (2.2\\%) \\\\ \n        32 & 8,775 (2.7\\%) \\\\ \n        33 & 4,691 (1.4\\%) \\\\ \n        34 & 5,411 (1.7\\%) \\\\ \n        35 & 4,595 (1.4\\%) \\\\ \n        36 & 5,659 (1.7\\%) \\\\ \n        37 & 3,494 (1.1\\%) \\\\ \n        38 & 3,938 (1.2\\%) \\\\ \n        39 & 2,489 (0.8\\%) \\\\ \n        40 & 2,932 (0.9\\%) \\\\ \n        41 & 1,941 (0.6\\%) \\\\ \n        42 & 3,197 (1.0\\%) \\\\ \n        43 & 1,244 (0.4\\%) \\\\ \n        44 & 1,794 (0.6\\%) \\\\ \n        45 & 1,442 (0.4\\%) \\\\ \n        46 & 1,322 (0.4\\%) \\\\ \n        47 & 1,251 (0.4\\%) \\\\ \n        48 & 1,238 (0.4\\%) \\\\ \n        49 & 900 (0.3\\%) \\\\ \n        50 & 800 (0.2\\%) \\\\ \n        51 & 651 (0.2\\%) \\\\ \n        52 & 1,152 (0.4\\%) \\\\ \n        53 & 347 (0.1\\%) \\\\ \n        54 & 436 (0.1\\%) \\\\ \n        55 & 346 (0.1\\%) \\\\ \n        56 & 409 (0.1\\%) \\\\ \n        57 & 295 (<0.1\\%) \\\\ \n        58 & 384 (0.1\\%) \\\\ \n        59 & 165 (<0.1\\%) \\\\ \n        60 & 202 (<0.1\\%) \\\\ \n        61 & 126 (<0.1\\%) \\\\ \n        62 & 342 (0.1\\%) \\\\ \n        63 & 92 (<0.1\\%) \\\\ \n        64 & 154 (<0.1\\%) \\\\ \n        65 & 129 (<0.1\\%) \\\\ \n        66 & 113 (<0.1\\%) \\\\ \n        67 & 139 (<0.1\\%) \\\\ \n        68 & 85 (<0.1\\%) \\\\ \n        69 & 85 (<0.1\\%) \\\\ \n        70 & 55 (<0.1\\%) \\\\ \n        71 & 65 (<0.1\\%) \\\\ \n        72 & 120 (<0.1\\%) \\\\ \n        73 & 26 (<0.1\\%) \\\\ \n        74 & 26 (<0.1\\%) \\\\ \n        75 & 26 (<0.1\\%) \\\\ \n        76 & 33 (<0.1\\%) \\\\ \n        77 & 28 (<0.1\\%) \\\\ \n        78 & 34 (<0.1\\%) \\\\ \n        79 & 20 (<0.1\\%) \\\\ \n        80 & 89 (<0.1\\%) \\\\ \n        81 & 295 (<0.1\\%) \\\\ \n        Unknown & 141,326 \\\\ \n    \\bottomrule\n    \\end{tabular*}\n    \\begin{minipage}{\\linewidth}\n    \\textsuperscript{\\textit{1}}n (\\%)\\\\\n    \\end{minipage}\n    \\end{table}\n    :::\n    :::\n\n\n\n5.  The table is really long, so a histogram would work much better to visualize how many observations are in each category:\n\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    ggplot(data = iat_prep, aes(x = myweight_002)) + \n      geom_histogram() +\n      geom_vline(aes(xintercept = mean(iat_prep$myweight_002, \n                                       na.rm = T)), \n                 color = \"red\", linewidth = 2)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning: Use of `iat_prep$myweight_002` is discouraged.\n    i Use `myweight_002` instead.\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning: Removed 141326 rows containing non-finite outside the scale range\n    (`stat_bin()`).\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    ![](BMI_help_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n    :::\n    :::\n\n\n\nWe need to convert the heights and weights to their cm and kg respectively. Since I only have a number category, I've gone into the codebook to find what each numbered category represents. If you put 8, you are 43 inches tall; 16:51 in; and 32:67in. Now I can use a line to see if I can create an equation to convert these values.\n\n$$\n\\begin{align}\nin & = m\\times cat+b \\\\\n43 &= m \\times 8 + b \\\\\nb & = 43-8m \\\\\n\\\\\n51 &= 16m + b \\\\\n51 &= 16m + (43-8m) \\\\\nm &=1 \\\\ \nb&=43-8m = 43-8=35 \\\\\n\\end{align}\n$$\n\nThen we double check with third set of points:\n\n$$\n\\begin{align}\n67 & = 1 \\times 32 + 35 \\\\\n67 & = 67 \\\\\n\\end{align}\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep$myheight_in = 1*iat_prep$myheight_002 + 35\n```\n:::\n\n\n\nThen we need to convert height to meters since BMI is in $kg/m^2$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep$myheight_m = 0.0254*iat_prep$myheight_in\n```\n:::\n\n\n\nOkay, now we need to do something similar for weight. Three more points to find the conversion: 10:90lb; 20:140lb; and 30: 190lb.\n\n$$\n\\begin{align}\nlb & = m\\times cat+b \\\\\n90 &= m \\times 10 + b \\\\\nb & = 90-10m \\\\\n\\\\\n140 &= 20m + b \\\\\n140 &= 20m + (90-10m) \\\\\nm &=5 \\\\ \nb&=90-10m = 90-50=40 \\\\\n\\end{align}\n$$\n\nThen we double check with third set of points:\n\n$$\n\\begin{align}\n190 & = 5 \\times 30 + 40 \\\\\n190 & = 190 \\\\\n\\end{align}\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep$myweight_lb = 5*iat_prep$myweight_002 + 40\n```\n:::\n\n\n\nThen we need to convert height to meters since BMI is in $kg/m^2$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep$myweight_kg = 0.453592*iat_prep$myweight_lb\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep$bmi = iat_prep$myweight_kg/(iat_prep$myheight_m)^2\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = iat_prep, aes(x = bmi)) + \n  geom_histogram(binwidth = 1) +\n  geom_vline(aes(xintercept = mean(bmi, \n                                   na.rm = T)), \n             color = \"red\", linewidth = 2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 142470 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](BMI_help_files/figure-pdf/unnamed-chunk-14-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nFrom histogram, looks like there are a couple observations at BMIs greater than 200. Let's double check that.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(iat_prep$bmi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   4.28   20.81   23.71   25.48   28.21  241.41  142470 \n```\n:::\n:::\n\n\n\nOkay, so we now know the max is 241.41. I want to see the observations that have BMIs this large. I'll take a look at their other values to see if there are any other issues.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niat_prep_bmi = iat_prep %>% filter(bmi > 200)\nhead(iat_prep_bmi, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     IAT_score att7 iam_001 identfat_001 myweight_002 myheight_002\n1  -0.61544208    4       1            5           81            2\n2   0.54476890    1       6            2           80            1\n3   0.70458996    1       2            3           80            2\n4   0.28206698    6       7            1           81            1\n5   0.33790313    5       7            3           81            2\n6   1.23311171    1       7            4           80            2\n7  -0.02357343    7       1            1           81            2\n8           NA    7       1            1           81            2\n9   0.33704837    4       1            1           81            2\n10 -0.47687442    4       4           NA           81            1\n   identthin_001 controlother_001 controlyou_001 mostpref_001 important_001\n1              1                5              5            4             5\n2              3                4              4            3             1\n3              3                3              2            4             5\n4              5                1              1            6             5\n5              4                3              2            1             4\n6              1                5              1            1             2\n7              5                1              1            2             5\n8              5                1              5            7             5\n9              5                1              1            4             4\n10            NA               NA              1           NA            NA\n   birthmonth birthyear month year raceomb_002    raceombmulti ethnicityomb edu\n1          12      1910     1 2021           8 [1,2,3,4,5,6,7]            1  12\n2          12      2009     1 2021           4                            1   1\n3          10      1916     1 2021           4                            1   1\n4          11      1910     2 2021          NA                            3   1\n5           4      2007     2 2021           6                            3  NA\n6           5      2001     2 2021           6                            2   5\n7           2      1980     2 2021           8 [1,2,3,4,5,6,7]            1   9\n8          NA        NA     2 2021          NA                           NA  NA\n9           5      1976     2 2021           5                            2   4\n10          9        NA     2 2021        -999                           NA  NA\n   edu_14 genderIdentity birthSex myheight_in myheight_m myweight_lb\n1      12            [2]        2          37     0.9398         445\n2       1            [1]        1          36     0.9144         440\n3       1            [1]        1          37     0.9398         440\n4       1            [6]        2          36     0.9144         445\n5      NA            [1]        1          37     0.9398         445\n6       5            [1]        1          37     0.9398         440\n7       9  [1,2,3,4,5,6]        2          37     0.9398         445\n8      NA                      NA          37     0.9398         445\n9       4            [1]        1          37     0.9398         445\n10     NA            [2]        2          36     0.9144         445\n   myweight_kg      bmi\n1     201.8484 228.5359\n2     199.5805 238.6963\n3     199.5805 225.9681\n4     201.8484 241.4087\n5     201.8484 228.5359\n6     199.5805 225.9681\n7     201.8484 228.5359\n8     201.8484 228.5359\n9     201.8484 228.5359\n10    201.8484 241.4087\n```\n:::\n:::\n\n\n\nLooking at the subset of individuals with BMIs greater than 200, I am reminded that there is some serious quality control that needs to be done to this dataset. Other variable observations indicate that some of these rows are individuals who did not accurately fill out their survey. Right now, we keep them in our dataset, but we will need to examine them for outliers.\n",
    "supporting": [
      "BMI_help_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{caption}\n\\usepackage{longtable}\n\\usepackage{colortbl}\n\\usepackage{array}\n\\usepackage{anyfontsize}\n\\usepackage{multirow}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}