---
title: "Homework 4"
subtitle: "BSTA 512/612"
author: "Your name here!!!"
description: "Due: Friday February 21, 2025 at 11pm"
date-modified: "today"
format: 
  html:
    link-external-newwindow: true
    toc: true
    embed-resources: true
---

::: callout-caution
This homework is not ready to be worked on!! Nicky needs to update it.
:::

```{=html}
<style>div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.height = 4, fig.width = 6, fig.align = "center")

library(tidyverse)
library(rstatix)
library(broom)
library(gt)
library(janitor)
library(readxl)
library(gridExtra)
library(ggfortify)  # autoplot(model)
library(gtsummary)
library(describedata) # gladder()
library(haven)
library(here)
```


## Directions

-   [Download the `.qmd` file here.](https://github.com/nwakim/BSTA_512_W25/blob/main/homework/HW_04.qmd)

-   You will need to download the datasets. Use [this link to download](https://ohsuitg-my.sharepoint.com/:f:/g/personal/wakim_ohsu_edu/EtimsrgruwZOvhVqgx31g0MBwLSTj2L53ilK_ZIw9-vucA?e=sBvCNu) the HW1 datasets needed in this assignment. If you do not want to make changes to the paths set in this document, then make sure the files are stored in a folder named "data" that is housed in the same location as your HW1 `.qmd` file.

-   Please upload your homework to Sakai. **Upload both your `.qmd` code file and the rendered `.html` file**

-   For each question, make sure to include all code and resulting output in the html file to support your answers

-   Show the work of your calculations using R code within a code chunk. Make sure that both your code and output are visible in the rendered html file. This is the default setting.

-   Write all answers in complete sentences as if communicating the results to a collaborator.

::: callout-tip
It is a good idea to try rendering your document from time to time as you go along! Note that rendering automatically saves your `.qmd` file and rendering frequently helps you catch your errors more quickly.
:::

## Questions

### Question 1

A team of nutrition experts investigated the influence of protein content in diet on the relationship between age (explanatory variable) and height (outcome, in centimeters) for children. Using the dataset, `CH12Q03.xls`, answer the following questions.

This question was adapted from [this textbook](https://catalog.lib.uchicago.edu/vufind/Record/7546272).

```{r}
#| echo: false
protein <- read_excel("./data/CH12Q03.xls") # change this to the appropriate file location
```

#### Part a

Using R, make a variable that is a factor for Diet. Make sure to check what values the original variable for Diet can take. How many indicator functions do you need to represent the categorical variable Diet (protein-rich vs. protein-poor)?


#### Part b

At a level of significance $\alpha = 0.10$, test whether protein diet modifies the effect of age on height. Justify your answer (e.g., perform a hypothesis test for the interaction between diet and age).

*Note: recall that an effect modifier is an interaction.*

#### Part c

Is it possible that diet is a confounder? Note: this will depend on your results from Part b. 

#### Part d

Write the fitted regression equation for our model in Part b. Write the respective regression lines for each specific diet group: protein rich and protein poor. Interpret the slope of each regression line (no need for a 95% CI here).

### Question 2

An experiment was conducted regarding a quantitative analysis of factors found in high-density lipoprotein (HDL) in a sample of human blood serum. Three variables thought to be predictive of, or associated with, HDL measurement (Y) were the total cholesterol (X1) and total triglyceride (X2) concentrations in the sample, plus the presence or absence of a certain sticky component of the serum called sinking pre-beta or SPB (X3), coded as 0 if absent and 1 if present. Using the dataset, `CH09Q05.xls`, answer the following questions.

```{r}
#| echo: false

HDL_factors <- read_excel(here("./data/CH09Q05.xls")) # change this to the appropriate file location
```

#### Part a

Use $\alpha= 0.05$, test whether if there is a crude association between HDL measurement and total cholesterol. Note: testing for a crude association means we fit a simple linear regression model and see if the association is significant. 

#### Part b

Sometimes simple linear regression leads us to believe that there is no association between two variables, but missing interaction might be obscuring the association. Use $\alpha= 0.1$ to test whether total triglyceride is an effect modifier of the association between HDL and total cholesterol. 

Note: Since the data frame has the variables named as $Y$, $X1$, and $X2$, you may use those in the regression equations, but when you are making a conclusion, please use the specific names of the variables to identify each. For example, $Y$ is actually HDL. 

Note: The plan is to cover interactions between two continuous covariates on Wednesday 2/21. We will not interpret the interaction coefficient for this, but we can test the interaction coefficient. Similar to the interaction for a binary covariate and a continuous covariate, we only need to test one coefficient, $\beta_3$.

#### Part c

Is it possible that total triglyceride is a confounder? No need to test this explicity.

Note: this will depend on your results from Part b. 


